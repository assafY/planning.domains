angular.module("app",["ngMaterial","ngAnimate","ngRoute","ngMessages","ngFileUpload"]).run(["$rootScope","$location","$timeout",function(e,o,l){e.$on("$viewContentLoaded",function(){l(function(){componentHandler.upgradeAllRegistered()})})}]),angular.module("app").controller("CompetitionController",["$rootScope","$scope","CompetitionService",function(e,o,l){e.leaderboard?o.leaderboard=e.leaderboard:l.fetchLeaderboard().success(function(l){l&&(console.log(l),o.leaderboard=e.leaderboard=l)})}]),angular.module("app").service("CompetitionService",["$http",function(e){this.fetchLeaderboard=function(){return e.get("/api/domains/leaderboard")}}]),angular.module("app").controller("DomainController",["$rootScope","$scope","DomainService",function(e,o,l){e.domains?o.domains=e.domains:l.fetchAll().success(function(l){l&&(o.domains=e.domains=l)}),o.getDomain=function(o){l.fetchDomain(o).success(function(o){e.currentDomain=o,l.singleDomainView()})}}]),angular.module("app").service("DomainService",["$http","$location",function(e,o){var l;this.fetchAll=function(){return e.get("/api/domains")},this.fetchDomain=function(o){return l=o,e({url:"/api/domains/"+o,method:"GET",params:{domainId:o}})},this.fetchPddlFile=function(o){return e({url:"/api/domains/"+l+"/"+o,method:"GET",params:{domainId:l,fileName:o}})},this.singleDomainView=function(){o.path("/view/domain")},this.problemView=function(){o.path("/view/domain/pddl")},this.domainView=function(){o.path("/view/domain/pddl")}}]),angular.module("app").controller("DomainViewController",["$rootScope","$scope","DomainService",function(e,o,l){o.domain=e.currentDomain,o.getPddlFile=function(o){l.fetchPddlFile(o).success(function(o){o&&(e.pddl=o),l.problemView()})}}]),angular.module("app").controller("MainController",["$scope",function(e){}]),angular.module("app").controller("PddlViewController",["$rootScope","$scope",function(e,o){o.pddl=e.pddl}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"MainController",templateUrl:"index.html"}).when("/view",{controller:"DomainController",templateUrl:"view.html"}).when("/view/domain",{controller:"DomainViewController",templateUrl:"domain-view.html"}).when("/view/domain/pddl",{controller:"PddlViewController",templateUrl:"pddl-view.html"}).when("/submit",{controller:"SubmitController",templateUrl:"submit.html"}).when("/submit/planner",{controller:"SubmitController",templateUrl:"submit-planner.html"}).when("/submit/success",{controller:"SubmitController",templateUrl:"success.html"}).when("/submit/error",{controller:"SubmitController",templateUrl:"error.html"}).when("/competition",{controller:"CompetitionController",templateUrl:"competition.html"})}]),angular.module("app").controller("SubmitController",["$scope","$rootScope","$timeout","Upload","SubmitService",function(e,o,l,n,i){e.allDomainFiles=[{id:"domain1"}],e.publishDate=new Date,e.formSubmitted=function(){return o.formSubmitted===!0?!0:!1},e.addDomain=function(){if(e.allDomainFiles[e.allDomainFiles.length-1].domainFile&&e.allDomainFiles[e.allDomainFiles.length-1].problemFiles){var o=e.allDomainFiles.length+1;e.allDomainFiles.push({id:"domain"+o})}},e.getUploadButton=function(e){angular.element(document.getElementById(e).click())},e.submitForm=function(){if(e.submitted=!0,e.allDomainFiles[0].domainFile&&e.allDomainFiles[0].problemFiles){e.form.publishDate=e.publishDate,e.form.domainFiles=[];for(var l=0;l<e.allDomainFiles.length;l++)if(e.allDomainFiles[l].domainFile&&e.allDomainFiles[l].problemFiles){problemFilesNames=[];for(var n=0;n<e.allDomainFiles[l].problemFiles.length;n++)problemFilesNames.push(e.allDomainFiles[l].problemFiles[n].name);e.form.domainFiles[l]={domainFile:e.allDomainFiles[l].domainFile.name,problemFiles:problemFilesNames}}i.submitDomainForm(e.form).success(function(l){o.formSubmitted=!0,e.uploadFiles(l).success(function(){i.domainNotifyServer(l).success(function(){i.formSuccess()})}).error(function(){i.formError()})})}},e.submitPlanner=function(){e.plannerForm.plannerFile&&(o.formSubmitted=!0,e.uploadPlanner().success(function(e){i.plannerNotifyServer(e).success(function(){i.formSuccess()})}).error(function(){i.formError()}))},e.uploadFiles=function(o){for(var l=[],i=0;i<e.allDomainFiles.length;++i)if(e.allDomainFiles[i].domainFile&&e.allDomainFiles[i].problemFiles){l.push(e.allDomainFiles[i].domainFile);for(var r=0;r<e.allDomainFiles[i].problemFiles.length;++r)l.push(e.allDomainFiles[i].problemFiles[r])}return n.upload({url:"/api/upload",arrayKey:"",data:{files:l,dirname:o}})},e.uploadPlanner=function(){return n.upload({url:"/api/upload/planner",data:{file:e.plannerForm.plannerFile,email:e.plannerForm.email,org:e.plannerForm.org}})}}]),angular.module("app").service("SubmitService",["$http","$location",function(e,o){this.submitDomainForm=function(o){return e({url:"/api/upload/domain-form",method:"POST",data:o})},this.plannerNotifyServer=function(o){return e({url:"/api/upload/planner-notify",method:"GET",params:{dirname:o}})},this.domainNotifyServer=function(o){return e({url:"/api/upload/domain-notify",method:"GET",params:{dirname:o}})},this.formSuccess=function(){o.path("/submit/success")},this.formError=function(){o.path("/submit/error")}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbXBldGl0aW9uLmN0cmwuanMiLCJjb21wZXRpdGlvbi5zdmMuanMiLCJkb21haW4uY3RybC5qcyIsImRvbWFpbi5zdmMuanMiLCJkb21haW52aWV3LmN0cmwuanMiLCJtYWluLmN0cmwuanMiLCJwZGRsdmlldy5jdHJsLmpzIiwicm91dGVzLmpzIiwic3VibWl0LmN0cmwuanMiLCJzdWJtaXQuc3ZjLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkcm9vdFNjb3BlIiwiJGxvY2F0aW9uIiwiJHRpbWVvdXQiLCIkb24iLCJjb21wb25lbnRIYW5kbGVyIiwidXBncmFkZUFsbFJlZ2lzdGVyZWQiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiQ29tcGV0aXRpb25TZXJ2aWNlIiwibGVhZGVyYm9hcmQiLCJmZXRjaExlYWRlcmJvYXJkIiwic3VjY2VzcyIsImNvbnNvbGUiLCJsb2ciLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwiZ2V0IiwiRG9tYWluU2VydmljZSIsImRvbWFpbnMiLCJmZXRjaEFsbCIsImdldERvbWFpbiIsImRvbWFpbklkIiwiZmV0Y2hEb21haW4iLCJkb21haW4iLCJjdXJyZW50RG9tYWluIiwic2luZ2xlRG9tYWluVmlldyIsImxvY2FsRG9tYWluSWQiLCJ1cmwiLCJtZXRob2QiLCJwYXJhbXMiLCJmZXRjaFBkZGxGaWxlIiwiZmlsZU5hbWUiLCJwYXRoIiwicHJvYmxlbVZpZXciLCJkb21haW5WaWV3IiwiZ2V0UGRkbEZpbGUiLCJwZGRsIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJVcGxvYWQiLCJTdWJtaXRTZXJ2aWNlIiwiYWxsRG9tYWluRmlsZXMiLCJpZCIsInB1Ymxpc2hEYXRlIiwiRGF0ZSIsImZvcm1TdWJtaXR0ZWQiLCJhZGREb21haW4iLCJsZW5ndGgiLCJkb21haW5GaWxlIiwicHJvYmxlbUZpbGVzIiwibmV3RG9tYWluSWQiLCJwdXNoIiwiZ2V0VXBsb2FkQnV0dG9uIiwiZWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjbGljayIsInN1Ym1pdEZvcm0iLCJzdWJtaXR0ZWQiLCJmb3JtIiwiZG9tYWluRmlsZXMiLCJpIiwicHJvYmxlbUZpbGVzTmFtZXMiLCJqIiwibmFtZSIsInN1Ym1pdERvbWFpbkZvcm0iLCJkaXJuYW1lIiwidXBsb2FkRmlsZXMiLCJkb21haW5Ob3RpZnlTZXJ2ZXIiLCJmb3JtU3VjY2VzcyIsImVycm9yIiwiZm9ybUVycm9yIiwic3VibWl0UGxhbm5lciIsInBsYW5uZXJGb3JtIiwicGxhbm5lckZpbGUiLCJ1cGxvYWRQbGFubmVyIiwiZGlyTmFtZSIsInBsYW5uZXJOb3RpZnlTZXJ2ZXIiLCJmaWxlcyIsInVwbG9hZCIsImFycmF5S2V5IiwiZGF0YSIsImZpbGUiLCJlbWFpbCIsIm9yZyIsImZvcm1EYXRhIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxPQUNBLGFBQ0EsWUFDQSxVQUNBLGFBQ0EsaUJBQ0FDLEtBQUEsYUFBQSxZQUFBLFdBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FDQUYsRUFBQUcsSUFBQSxxQkFBQSxXQUNBRCxFQUFBLFdBQ0FFLGlCQUFBQyw4QkNUQVIsUUFBQUMsT0FBQSxPQUNBUSxXQUFBLHlCQUFBLGFBQUEsU0FBQSxxQkFBQSxTQUFBTixFQUFBTyxFQUFBQyxHQUNBUixFQUFBUyxZQVFBRixFQUFBRSxZQUFBVCxFQUFBUyxZQVBBRCxFQUFBRSxtQkFBQUMsUUFBQSxTQUFBRixHQUNBQSxJQUNBRyxRQUFBQyxJQUFBSixHQUNBRixFQUFBRSxZQUFBVCxFQUFBUyxZQUFBQSxRQ05BWixRQUFBQyxPQUFBLE9BQ0FnQixRQUFBLHNCQUFBLFFBQUEsU0FBQUMsR0FFQUMsS0FBQU4saUJBQUEsV0FDQSxNQUFBSyxHQUFBRSxJQUFBLGdDQ0pBcEIsUUFBQUMsT0FBQSxPQUNBUSxXQUFBLG9CQUFBLGFBQUEsU0FBQSxnQkFBQSxTQUFBTixFQUFBTyxFQUFBVyxH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QUFBcUMsZUFBQW9CLEdBQUFiLFlBQ0E1QyxFQUFBcUMsZUFBQW9CLEdBQUFaLGFBQUEsQ0FDQTZCLEVBQUEzQixLQUFBL0MsRUFBQXFDLGVBQUFvQixHQUFBYixXQUVBLEtBQUEsR0FBQWUsR0FBQSxFQUFBQSxFQUFBM0QsRUFBQXFDLGVBQUFvQixHQUFBWixhQUFBRixTQUFBZ0IsRUFDQWUsRUFBQTNCLEtBQUEvQyxFQUFBcUMsZUFBQW9CLEdBQUFaLGFBQUFjLElBTUEsTUFBQXhCLEdBQUF3QyxRQUNBdEQsSUFBQSxjQUNBdUQsU0FBQSxHQUNBQyxNQUFBSCxNQUFBQSxFQUFBWixRQUFBQSxNQUlBOUQsRUFBQXVFLGNBQUEsV0FDQSxNQUFBcEMsR0FBQXdDLFFBQ0F0RCxJQUFBLHNCQUNBd0QsTUFDQUMsS0FBQTlFLEVBQUFxRSxZQUFBQyxZQUNBUyxNQUFBL0UsRUFBQXFFLFlBQUFVLE1BQ0FDLElBQUFoRixFQUFBcUUsWUFBQVcsV0M1R0ExRixRQUFBQyxPQUFBLE9BQ0FnQixRQUFBLGlCQUFBLFFBQUEsWUFBQSxTQUFBQyxFQUFBZCxHQUNBZSxLQUFBb0QsaUJBQUEsU0FBQW9CLEdBQ0EsTUFBQXpFLElBQ0FhLElBQUEsMEJBQ0FDLE9BQUEsT0FDQXVELEtBQUFJLEtBSUF4RSxLQUFBZ0Usb0JBQUEsU0FBQUQsR0FDQSxNQUFBaEUsSUFDQWEsSUFBQSw2QkFDQUMsT0FBQSxNQUNBQyxRQUFBdUMsUUFBQVUsTUFJQS9ELEtBQUF1RCxtQkFBQSxTQUFBUSxHQUNBLE1BQUFoRSxJQUNBYSxJQUFBLDRCQUNBQyxPQUFBLE1BQ0FDLFFBQUF1QyxRQUFBVSxNQUlBL0QsS0FBQXdELFlBQUEsV0FDQXZFLEVBQUFnQyxLQUFBLG9CQUdBakIsS0FBQTBELFVBQUEsV0FDQXpFLEVBQUFnQyxLQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG5cdCduZ01hdGVyaWFsJyxcblx0J25nQW5pbWF0ZScsXG5cdCduZ1JvdXRlJyxcblx0J25nTWVzc2FnZXMnLFxuXHQnbmdGaWxlVXBsb2FkJ1xuXSkucnVuKGZ1bmN0aW9uKCRyb290U2NvcGUsICRsb2NhdGlvbiwgJHRpbWVvdXQpIHtcbiAgICAkcm9vdFNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29tcG9uZW50SGFuZGxlci51cGdyYWRlQWxsUmVnaXN0ZXJlZCgpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0NvbXBldGl0aW9uQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgQ29tcGV0aXRpb25TZXJ2aWNlKSB7XG5cdGlmICghJHJvb3RTY29wZS5sZWFkZXJib2FyZCkge1xuICAgICAgICBDb21wZXRpdGlvblNlcnZpY2UuZmV0Y2hMZWFkZXJib2FyZCgpLnN1Y2Nlc3MgKGZ1bmN0aW9uIChsZWFkZXJib2FyZCkge1xuICAgICAgICAgICAgaWYgKGxlYWRlcmJvYXJkKSB7XG4gICAgICAgICAgICBcdGNvbnNvbGUubG9nKGxlYWRlcmJvYXJkKVxuICAgICAgICAgICAgICAgICRzY29wZS5sZWFkZXJib2FyZCA9ICRyb290U2NvcGUubGVhZGVyYm9hcmQgPSBsZWFkZXJib2FyZFxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICAgICRzY29wZS5sZWFkZXJib2FyZCA9ICRyb290U2NvcGUubGVhZGVyYm9hcmRcbiAgICB9XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdDb21wZXRpdGlvblNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCkge1xuXG4gICAgdGhpcy5mZXRjaExlYWRlcmJvYXJkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvZG9tYWlucy9sZWFkZXJib2FyZCcpXG4gICAgfVxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdEb21haW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCBEb21haW5TZXJ2aWNlKSB7XG5cdGlmICghJHJvb3RTY29wZS5kb21haW5zKSB7XG5cdFx0RG9tYWluU2VydmljZS5mZXRjaEFsbCgpLnN1Y2Nlc3MgKGZ1bmN0aW9uIChkb21haW5zKSB7XG5cdFx0XHRpZiAoZG9tYWlucylcblx0XHRcdFx0JHNjb3BlLmRvbWFpbnMgPSAkcm9vdFNjb3BlLmRvbWFpbnMgPSBkb21haW5zO1xuXHRcdH0pO1xuXHR9IGVsc2Uge1xuXHRcdCRzY29wZS5kb21haW5zID0gJHJvb3RTY29wZS5kb21haW5zO1xuXHR9XG5cdCRzY29wZS5nZXREb21haW4gPSBmdW5jdGlvbihkb21haW5JZCkge1xuXHRcdERvbWFpblNlcnZpY2UuZmV0Y2hEb21haW4oZG9tYWluSWQpLnN1Y2Nlc3MgKGZ1bmN0aW9uIChkb21haW4pIHtcblx0XHRcdCRyb290U2NvcGUuY3VycmVudERvbWFpbiA9IGRvbWFpbjtcblx0XHRcdERvbWFpblNlcnZpY2Uuc2luZ2xlRG9tYWluVmlldygpO1xuXHRcdH0pO1xuXHR9XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdEb21haW5TZXJ2aWNlJywgZnVuY3Rpb24oJGh0dHAsICRsb2NhdGlvbikge1xuXG5cdHZhciBsb2NhbERvbWFpbklkO1xuXG5cdHRoaXMuZmV0Y2hBbGwgPSBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9kb21haW5zJyk7XG5cdH07XG5cblx0dGhpcy5mZXRjaERvbWFpbiA9IGZ1bmN0aW9uKGRvbWFpbklkKSB7XG5cdFx0bG9jYWxEb21haW5JZCA9IGRvbWFpbklkO1xuXHRcdHJldHVybiAkaHR0cCh7XG5cdFx0ICAgIHVybDogJy9hcGkvZG9tYWlucy8nICsgZG9tYWluSWQsIFxuXHRcdCAgICBtZXRob2Q6IFwiR0VUXCIsXG5cdFx0ICAgIHBhcmFtczogeydkb21haW5JZCc6IGRvbWFpbklkfVxuXHRcdH0pO1xuXHR9O1xuXG5cdHRoaXMuZmV0Y2hQZGRsRmlsZSA9IGZ1bmN0aW9uKGZpbGVOYW1lKSB7XG5cdFx0cmV0dXJuICRodHRwKHtcblx0XHRcdHVybDogJy9hcGkvZG9tYWlucy8nICsgbG9jYWxEb21haW5JZCArICcvJyArIGZpbGVOYW1lLFxuXHRcdFx0bWV0aG9kOiBcIkdFVFwiLFxuXHRcdFx0cGFyYW1zOiB7XG5cdFx0XHRcdCdkb21haW5JZCc6IGxvY2FsRG9tYWluSWQsXG5cdFx0XHRcdCdmaWxlTmFtZSc6IGZpbGVOYW1lXG5cdFx0XHR9XG5cdFx0fSk7XG5cdH07XG5cblx0dGhpcy5zaW5nbGVEb21haW5WaWV3ID0gZnVuY3Rpb24oKSB7XG5cdFx0JGxvY2F0aW9uLnBhdGgoJy92aWV3L2RvbWFpbicpXG5cdH07XG5cblx0dGhpcy5wcm9ibGVtVmlldyA9IGZ1bmN0aW9uKCkge1xuXHRcdCRsb2NhdGlvbi5wYXRoKCcvdmlldy9kb21haW4vcGRkbCcpXG5cdH07XG5cdFxuXHR0aGlzLmRvbWFpblZpZXcgPSBmdW5jdGlvbigpIHtcblx0XHQkbG9jYXRpb24ucGF0aCgnL3ZpZXcvZG9tYWluL3BkZGwnKVxuXHR9O1xuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdEb21haW5WaWV3Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgRG9tYWluU2VydmljZSkge1xuXHRcblxuXHQkc2NvcGUuZG9tYWluID0gJHJvb3RTY29wZS5jdXJyZW50RG9tYWluO1xuXG5cdCRzY29wZS5nZXRQZGRsRmlsZSA9IGZ1bmN0aW9uKGZpbGVOYW1lKSB7XG5cdFx0RG9tYWluU2VydmljZS5mZXRjaFBkZGxGaWxlKGZpbGVOYW1lKS5zdWNjZXNzIChmdW5jdGlvbiAocGRkbCkge1xuXHRcdFx0aWYgKHBkZGwpXG5cdFx0XHRcdCRyb290U2NvcGUucGRkbCA9IHBkZGw7XG5cdFx0XHREb21haW5TZXJ2aWNlLnByb2JsZW1WaWV3KClcblx0XHR9KVxuXHR9XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHRcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignUGRkbFZpZXdDb250cm9sbGVyJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSkge1xuXHQkc2NvcGUucGRkbCA9ICRyb290U2NvcGUucGRkbFxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XG5cdCRyb3V0ZVByb3ZpZGVyXG5cdC53aGVuKCcvJywgeyBjb250cm9sbGVyOiAnTWFpbkNvbnRyb2xsZXInLCB0ZW1wbGF0ZVVybDogJ2luZGV4Lmh0bWwnIH0pXG5cdC53aGVuKCcvdmlldycsIHsgY29udHJvbGxlcjogJ0RvbWFpbkNvbnRyb2xsZXInLCB0ZW1wbGF0ZVVybDogJ3ZpZXcuaHRtbCcgfSlcblx0LndoZW4oJy92aWV3L2RvbWFpbicsIHsgY29udHJvbGxlcjogJ0RvbWFpblZpZXdDb250cm9sbGVyJywgdGVtcGxhdGVVcmw6ICdkb21haW4tdmlldy5odG1sJyB9KVxuXHQud2hlbignL3ZpZXcvZG9tYWluL3BkZGwnLCB7IGNvbnRyb2xsZXI6ICdQZGRsVmlld0NvbnRyb2xsZXInLCB0ZW1wbGF0ZVVybDogJ3BkZGwtdmlldy5odG1sJyB9KVxuXHQud2hlbignL3N1Ym1pdCcsIHsgY29udHJvbGxlcjogJ1N1Ym1pdENvbnRyb2xsZXInLCB0ZW1wbGF0ZVVybDogJ3N1Ym1pdC5odG1sJyB9KVxuXHQud2hlbignL3N1Ym1pdC9wbGFubmVyJywgeyBjb250cm9sbGVyOiAnU3VibWl0Q29udHJvbGxlcicsIHRlbXBsYXRlVXJsOiAnc3VibWl0LXBsYW5uZXIuaHRtbCcgfSlcblx0LndoZW4oJy9zdWJtaXQvc3VjY2VzcycsIHsgY29udHJvbGxlcjogJ1N1Ym1pdENvbnRyb2xsZXInLCB0ZW1wbGF0ZVVybDogJ3N1Y2Nlc3MuaHRtbCcgfSlcblx0LndoZW4oJy9zdWJtaXQvZXJyb3InLCB7IGNvbnRyb2xsZXI6ICdTdWJtaXRDb250cm9sbGVyJywgdGVtcGxhdGVVcmw6ICdlcnJvci5odG1sJyB9KVxuXHQud2hlbignL2NvbXBldGl0aW9uJywgeyBjb250cm9sbGVyOiAnQ29tcGV0aXRpb25Db250cm9sbGVyJywgdGVtcGxhdGVVcmw6ICdjb21wZXRpdGlvbi5odG1sJyB9KVxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdTdWJtaXRDb250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgJHRpbWVvdXQsIFVwbG9hZCwgU3VibWl0U2VydmljZSkge1xuXHRcblx0JHNjb3BlLmFsbERvbWFpbkZpbGVzID0gW3tpZDogJ2RvbWFpbjEnfV07XG5cdCRzY29wZS5wdWJsaXNoRGF0ZSA9IG5ldyBEYXRlKCk7XG5cdFxuXHQkc2NvcGUuZm9ybVN1Ym1pdHRlZCA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmICgkcm9vdFNjb3BlLmZvcm1TdWJtaXR0ZWQgPT09IHRydWUpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQkc2NvcGUuYWRkRG9tYWluID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCRzY29wZS5hbGxEb21haW5GaWxlc1skc2NvcGUuYWxsRG9tYWluRmlsZXMubGVuZ3RoIC0gMV0uZG9tYWluRmlsZSAmJlxuXHRcdFx0JHNjb3BlLmFsbERvbWFpbkZpbGVzWyRzY29wZS5hbGxEb21haW5GaWxlcy5sZW5ndGggLSAxXS5wcm9ibGVtRmlsZXMpIHtcblx0XHRcdHZhciBuZXdEb21haW5JZCA9ICRzY29wZS5hbGxEb21haW5GaWxlcy5sZW5ndGggKyAxO1xuXHRcdFx0JHNjb3BlLmFsbERvbWFpbkZpbGVzLnB1c2goeydpZCc6J2RvbWFpbicgKyBuZXdEb21haW5JZH0pO1xuXHRcdH1cblx0fTtcblxuXHQkc2NvcGUuZ2V0VXBsb2FkQnV0dG9uID0gZnVuY3Rpb24gKGlkKSB7XG5cdFx0YW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5jbGljaygpKTtcblx0fVxuXG5cdCRzY29wZS5zdWJtaXRGb3JtID0gZnVuY3Rpb24gKCkge1xuXHRcdC8vIGNoZWNrIGlmIHRoZSBmaXJzdCBkb21haW4gYW5kIHByb2JsZW0gZmlsZXMgcGFpciB3YXMgc2VsZWN0ZWRcblx0XHQkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTsgLy8gbmVjZXNzYXJ5P1xuXHRcdGlmICgkc2NvcGUuYWxsRG9tYWluRmlsZXNbMF0uZG9tYWluRmlsZSAmJiAkc2NvcGUuYWxsRG9tYWluRmlsZXNbMF0ucHJvYmxlbUZpbGVzKSB7XG5cdFx0XHQkc2NvcGUuZm9ybS5wdWJsaXNoRGF0ZSA9ICRzY29wZS5wdWJsaXNoRGF0ZTtcblx0XHRcdCRzY29wZS5mb3JtLmRvbWFpbkZpbGVzXHQ9IFtdXHRcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUuYWxsRG9tYWluRmlsZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0Ly8gaWYgYm90aCBhIGRvbWFpbiBhbmQgcHJvYmxlbSBmaWxlcyBoYXZlIGJlZW4gc2VsZWN0ZWQgZm9yIHRoaXMgZW50cnlcblx0XHRcdFx0aWYgKCRzY29wZS5hbGxEb21haW5GaWxlc1tpXS5kb21haW5GaWxlICYmXG5cdFx0XHRcdFx0JHNjb3BlLmFsbERvbWFpbkZpbGVzW2ldLnByb2JsZW1GaWxlcykge1xuXG5cdFx0XHRcdFx0cHJvYmxlbUZpbGVzTmFtZXMgPSBbXVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgJHNjb3BlLmFsbERvbWFpbkZpbGVzW2ldLnByb2JsZW1GaWxlcy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdFx0cHJvYmxlbUZpbGVzTmFtZXMucHVzaCgkc2NvcGUuYWxsRG9tYWluRmlsZXNbaV0ucHJvYmxlbUZpbGVzW2pdLm5hbWUpXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0JHNjb3BlLmZvcm0uZG9tYWluRmlsZXNbaV0gPSB7XG5cdFx0XHRcdFx0XHRkb21haW5GaWxlOiAkc2NvcGUuYWxsRG9tYWluRmlsZXNbaV0uZG9tYWluRmlsZS5uYW1lLFxuXHRcdFx0XHRcdFx0cHJvYmxlbUZpbGVzOiBwcm9ibGVtRmlsZXNOYW1lc1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRTdWJtaXRTZXJ2aWNlLnN1Ym1pdERvbWFpbkZvcm0oJHNjb3BlLmZvcm0pLiBzdWNjZXNzKGZ1bmN0aW9uIChkaXJuYW1lKSB7XG5cdFx0XHRcdFx0JHJvb3RTY29wZS5mb3JtU3VibWl0dGVkID0gdHJ1ZTtcblxuXHRcdFx0XHRcdCRzY29wZS51cGxvYWRGaWxlcyhkaXJuYW1lKS5zdWNjZXNzIChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRTdWJtaXRTZXJ2aWNlLmRvbWFpbk5vdGlmeVNlcnZlcihkaXJuYW1lKS5zdWNjZXNzKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0U3VibWl0U2VydmljZS5mb3JtU3VjY2VzcygpO1xuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0XHR9KS5lcnJvciAoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0U3VibWl0U2VydmljZS5mb3JtRXJyb3IoKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHQkc2NvcGUuc3VibWl0UGxhbm5lciA9IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAoJHNjb3BlLnBsYW5uZXJGb3JtLnBsYW5uZXJGaWxlKSB7XG5cdFx0XHQkcm9vdFNjb3BlLmZvcm1TdWJtaXR0ZWQgPSB0cnVlO1xuXG5cdFx0XHQkc2NvcGUudXBsb2FkUGxhbm5lcigpLnN1Y2Nlc3MgKGZ1bmN0aW9uIChkaXJOYW1lKSB7XG5cdFx0XHRcdFN1Ym1pdFNlcnZpY2UucGxhbm5lck5vdGlmeVNlcnZlcihkaXJOYW1lKS5zdWNjZXNzIChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0U3VibWl0U2VydmljZS5mb3JtU3VjY2VzcygpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSkuZXJyb3IgKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0U3VibWl0U2VydmljZS5mb3JtRXJyb3IoKTtcblx0XHRcdH0pXG5cdFx0fVxuXHR9XG5cblx0JHNjb3BlLnVwbG9hZEZpbGVzID0gZnVuY3Rpb24gKGRpcm5hbWUpIHtcblx0XHR2YXIgZmlsZXMgPSBbXVxuXG5cdFx0Ly8gZmlsbCBmaWxlcyBhcnJheSB3aXRoIGFsbCBmaWxlcyBzZWxlY3RlZFxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgJHNjb3BlLmFsbERvbWFpbkZpbGVzLmxlbmd0aDsgKytpKSB7XG5cdFx0XHQvLyBpZiBib3RoIGEgZG9tYWluIGFuZCBwcm9ibGVtIGZpbGVzIGhhdmUgYmVlbiBzZWxlY3RlZCBmb3IgdGhpcyBlbnRyeVxuXHRcdFx0aWYgKCRzY29wZS5hbGxEb21haW5GaWxlc1tpXS5kb21haW5GaWxlICYmXG5cdFx0XHRcdCRzY29wZS5hbGxEb21haW5GaWxlc1tpXS5wcm9ibGVtRmlsZXMpIHtcblx0XHRcdFx0ZmlsZXMucHVzaCgkc2NvcGUuYWxsRG9tYWluRmlsZXNbaV0uZG9tYWluRmlsZSlcblxuXHRcdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8ICRzY29wZS5hbGxEb21haW5GaWxlc1tpXS5wcm9ibGVtRmlsZXMubGVuZ3RoOyArK2opIHtcblx0XHRcdFx0XHRmaWxlcy5wdXNoKCRzY29wZS5hbGxEb21haW5GaWxlc1tpXS5wcm9ibGVtRmlsZXNbal0pXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBzZW5kIGZpbGVzIGFycmF5IHRvIG5vZGUganNcblx0XHRyZXR1cm4gVXBsb2FkLnVwbG9hZCh7XG5cdFx0XHRcdHVybDogJy9hcGkvdXBsb2FkJyxcblx0XHRcdFx0YXJyYXlLZXk6ICcnLFxuXHRcdFx0XHRkYXRhOiB7ZmlsZXM6IGZpbGVzLCBkaXJuYW1lOiBkaXJuYW1lfVxuXHRcdFx0fSlcblx0fVxuXG5cdCRzY29wZS51cGxvYWRQbGFubmVyID0gZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiBVcGxvYWQudXBsb2FkKHtcblx0XHRcdHVybDogJy9hcGkvdXBsb2FkL3BsYW5uZXInLFxuXHRcdFx0ZGF0YToge1xuXHRcdFx0XHRmaWxlOiAkc2NvcGUucGxhbm5lckZvcm0ucGxhbm5lckZpbGUsXG5cdFx0XHRcdGVtYWlsOiAkc2NvcGUucGxhbm5lckZvcm0uZW1haWwsXG5cdFx0XHRcdG9yZzogJHNjb3BlLnBsYW5uZXJGb3JtLm9yZ1xuXHRcdFx0fVxuXHRcdH0pXG5cdH1cbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnU3VibWl0U2VydmljZScsIGZ1bmN0aW9uKCRodHRwLCAkbG9jYXRpb24pIHtcblx0XHR0aGlzLnN1Ym1pdERvbWFpbkZvcm0gPSBmdW5jdGlvbiAoZm9ybURhdGEpIHtcblx0XHRcdHJldHVybiAkaHR0cCh7XG5cdFx0XHRcdHVybDogJy9hcGkvdXBsb2FkL2RvbWFpbi1mb3JtJyxcblx0XHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRcdGRhdGE6IGZvcm1EYXRhXG5cdFx0XHR9KVxuXHRcdH07XG5cblx0XHR0aGlzLnBsYW5uZXJOb3RpZnlTZXJ2ZXIgPSBmdW5jdGlvbiAoZGlyTmFtZSkge1xuXHRcdFx0cmV0dXJuICRodHRwKHtcblx0XHRcdFx0dXJsOiAnL2FwaS91cGxvYWQvcGxhbm5lci1ub3RpZnknLFxuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRwYXJhbXM6IHsnZGlybmFtZSc6IGRpck5hbWV9XG5cdFx0XHR9KVxuXHRcdH1cblxuXHRcdHRoaXMuZG9tYWluTm90aWZ5U2VydmVyID0gZnVuY3Rpb24gKGRpck5hbWUpIHtcblx0XHRcdHJldHVybiAkaHR0cCh7XG5cdFx0XHRcdHVybDogJy9hcGkvdXBsb2FkL2RvbWFpbi1ub3RpZnknLFxuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRwYXJhbXM6IHsnZGlybmFtZSc6IGRpck5hbWV9XG5cdFx0XHR9KVxuXHRcdH1cblxuXHRcdHRoaXMuZm9ybVN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQkbG9jYXRpb24ucGF0aCgnL3N1Ym1pdC9zdWNjZXNzJyk7XG5cdFx0fTtcblxuXHRcdHRoaXMuZm9ybUVycm9yID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0JGxvY2F0aW9uLnBhdGgoJy9zdWJtaXQvZXJyb3InKTtcblx0XHR9O1xufSkiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
